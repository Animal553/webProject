1. ## mysql explain是什么？有什么作用？描述下type

   ```
   mysql explain的作用是模拟Mysql优化器是如何执行SQL查询语句的，从而知道Mysql是如何处理用户的SQL语句，提高数据检索效率，降低数据库的IO成本。
   type列：访问类型由好到差system > const > eq_ref > ref > range > index > ALL
   ```

   

2. ## mysql中有哪几种锁？表锁、行锁、页锁区别？

   ```
   行锁、表锁、页锁、悲观锁、乐观锁等
   （1）表级锁：开销小，加锁快；不会出现死锁；锁定力度大，发生锁冲突的率最高，并发度最低
   （2）行级锁：开销大，加锁慢；会出现死锁；锁定力度最小，发生锁冲突的概率最低，并发度也最高。
   （3）页面锁：开销和加锁时间界于表锁和行锁之间；会出现死锁；锁定力度界于表 锁和行锁之间，并发度一般。
   ```

   

3. ## 悲观锁 乐观锁 的区别

   ```
   悲观锁
   每次拿数据都以为别人会修改，所以每次拿数据时都会上锁。
   实现：开启事务，启用锁机制
   乐观锁
   每次拿数据时候都认为别人不会修改，所以不会上锁，但是在更新数据时候会判断在此期间是否有人更新过。
   实现：1.使用版本号2.使用时间戳
   ```

   

4. ## 什么是索引？索引的种类有哪些，描述索引的优缺点?

   ```
   数据库索引是：数据库索引就像是一本书的目录一样，使用它可以让你在数据库里搜索查询的速度大大提升。
   索引是帮助MySQL高效获取数据的排好序的数据结构
   索引存储在文件里
   索引结构（索引底层的数据结构）（ 二叉树，红黑树， Hash， B-树）
   索引的几种类型分别是普通索引、唯一索引、聚集索引、主键索引、全文索引几种。
   
   二. 索引的优点
   索引能够提高数据检索的效率，降低数据库的IO成本。
   加速两个表之间的连接，一般是在外键上创建索引
   在使用分组和排序子句进行数据检索时，同样可以显著减少查询中分组和排序的时间
   保证数据库表中每一行的数据的唯一性
   三. 索引的缺点
   在我们建立数据库的时候，需要花费的时间去建立和维护索引，而且随着数据量的增加，需要维护它的时间也会增加。
   索引需要占物理空间，除了数据表占用数据空间之外，每一个索引还要占用一定的物理空间，如果需要建立聚簇索引，那么需要占用的空间会更大
   以表中的数据进行增、删、改的时候，索引也要动态的维护
   ```

   

5. ## 设计索引的原则？(不少于4条)

   ```
   1．原则上表索引的个数不能超过5个；
   2．原则上单个字段上的索引不能超过2个；
   3．原则上复合索引引用的字段不能超过3个字段；
   4．原则上分区表的索引类型全部使用LOCAL索引；
   5．配置数据类的表，如数据量比较少，除了主键外原则上不建索引
   6．接口类和工单类的表，尽可能减少索引数量或者不建索引
   7．索引引用字段的顺序尽可能与使用该索引的查询中ORDER BY字段顺序保持一致
   ```

   

6. ## 什么情况下索引会失效？（不少于4条）

   ```
   1.对于创建的多列索引（复合索引），不是使用的第一部分就不会使用索引
   2.对于使用 like 查询， 查询如果是 ‘%aaa’ 不会使用索引，而 ‘aaa%’ 会使用到索引。
   3.如果条件中有 or， 有条件没有使用索引，即使其中有条件带索引也不会使用，换言之， 就是要求使用的所有字段，都必须单独使用时能使用索引。
   4.如果列类型是字符串，那么一定要在条件中使用引号引用起来，否则不使用索引。
   5.如果mysql认为全表扫面要比使用索引快，则不使用索引。
   ```

   

7. ## Btree和Hash区别

   ```
   Btree类型的索引，Btree又称b+树
   （1）所有关键字都出现在叶子结点的链表中（稠密索引），且链表中的关键字恰好是有序的；（只有根节点存储关键字最后树的末梢才有值)
   （2）非叶子结点相当于是叶子结点的索引（稀疏索引），叶子结点相当于是存储（关键字）数据的数据层。（非根节点，存储的其实是指向根节点的索引）
   （3）不可能在非叶子结点存数据。
   （4）根节点横向也有链指针(方便快速顺藤摸瓜嘛，没这个指针，就算下一个取的值是挨着的邻居，也得跑个圈才能拿到)
   通过上述分析，所以能直观的理解出Btree类型在我们查询数据时适合用于范围查找，在某一叶子的节点到另一节点的范围。例如<,>,orderby等场景都可使用。
   
   
   Hash索引，其检索效率非常高的一种精确定位索引。
   Hash索引不像B-Tree 索引需要从根节点到枝节点，最后才能访问到页节点这样多次的IO访问，所以 Hash 索引的查询效率要远高于 B-Tree 索引，它会将计算出的Hash值和对对应的行指针信息记录在Hash表中。但是虽然Hash效率很高但是同样也有很多的弊端存在和限制存在。
   （1）Hash 索引仅仅能满足"=","IN"和"<=>"查询，不能使用范围查询。
   （2）Hash 索引无法被用来避免数据的排序操作。
   （3）Hash 索引不能利用部分索引键（组合索引）查询。
   （4）Hash 索引在任何时候都不能避免表扫描。
   （5）Hash 索引遇到大量Hash值相等的情况后性能并不一定就会比B-Tree索引高。
   ```

   

8. ## 数据库优化方案？（至少3条）

   ```
   1.对查询进行优化，要尽量避免全表扫描，首先应考虑在where 及 order by 涉及的列上建立索引。
   2.应尽量避免在 where 子句中对字段进行 null 值判断，否则将导致引擎放弃使用索引而进行全表扫描
   3.应尽量避免在 where 子句中使用 != 或 <> 操作符，否则将引擎放弃使用索引而进行全表扫描。
   4.应尽量避免在 where 子句中使用 or 来连接条件，如果一个字段有索引，一个字段没有索引，将导致引擎放弃使用索引而进行全表扫描
   5.in 和 not in 也要慎用，否则会导致全表扫描
   6.应尽量避免在where子句中对字段进行函数操作，这将导致引擎放弃使用索引而进行全表扫描。
   ```

   

9. ## 什么是存储过程？有什么优缺点？

   ```
   就是一些编译好了的SQL语句，这些SQL语句代码像一个方法一样实现一些功能（对单表或多表的增删改查），然后给这些代码块取一个名字，在用到这个功能的时候调用即可。
   
   优点：
   1.存储过程是一个预编译的代码块，执行效率比较高
   2.存储过程在服务器端运行，减少客户端的压力
   3.允许模块化程序设计，只需要创建一次过程，以后在程序中就可以调用该过程任意次，类似方法的复用
   4.一个存储过程替代大量T_SQL语句 ，可以降低网络通信量，提高通信速率
   5.可以一定程度上确保数据安全
   缺点：
   1.调试麻烦（没有像开发程序那样容易）
   2.可移植性不灵活（因为存储过程依赖于具体的数据库）
   ```

1. ## 什么是视图，视图有什么作用？

   ```
   视图(VIEW)也被称作虚表，即虚拟的表，是一组数据的逻辑表示,其本质是对应于一条SELECT语句，结果集被赋予一个名字，即视图名字。
   视图本身并不包含任何数据，它只包含映射到基表的一个查询语句，当基表数据发生变化，视图数据也随之变化。
   
   简单性。看到的就是需要的。视图不仅可以简化用户对数据的理解,也可以简化他们的操作。那些被经常使用的查询可以被定义为视图,从而使得用户不必为以后的操作每次指定全部的条件。 
   
   安全性。通过视图用户只能查询和修改他们所能见到的数据。但不能授权到数据库特定行和特定的列上。通过视图,用户可以被限制在数据的不同子集上:使用权限可被限制在另一视图的一个子集上,或是一些视图和基表合并后的子集上。 
   
   逻辑数据独立性。视图可帮助用户屏蔽真实表结构变化带来的影响。
   ```

   

2. ## 什么是分布式、微服务、集群？

   ```
   集群：同一个业务，部署在多个服务器上
   分布式：一个业务分拆多个子业务，部署在不同的服务器上
   微服务：一个业务分拆多个子业务，部署在不同的服务器上运行
   ```

3. ## SOA架构的优点和缺点

   ```
   优点：
   1、微服务对服务的拆分变更的更细（复用性强）。
   2、可根据需求使用新的技术
   3、开发速度快（周期少）。适用于互联网项目。
   缺点：
   微服务过多，对服务的治理成本高。
   服务的部署难度加大-->**（Docker-->k8s)**
   技术难点在增加（分布式事务......)
   ```

   

4. ## 分布式+微服务架构带来了新的技术新的问题？描述

   ```
   分布式事务   两(二）阶段提交
   分布式锁  Redis SETNX/Zookepper
   分布式Session  Spring Session(RedisCluster)
   分布式日志  elk
   分布式任务
   ```

   
