<!DOCTYPE html>
<html class="x-admin-sm">
    
    <head>
        <meta charset="UTF-8">
        <title>欢迎页面-X-admin2.2</title>
        <meta name="renderer" content="webkit">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <meta name="viewport" content="width=device-width,user-scalable=yes, minimum-scale=0.4, initial-scale=0.8,target-densitydpi=low-dpi" />
        <link rel="stylesheet" href="./css/font.css">
        <link rel="stylesheet" href="./css/xadmin.css">
        <script type="text/javascript" src="./lib/layui/layui.js" charset="utf-8"></script>
        <script type="text/javascript" src="./js/xadmin.js"></script>
</head>
    
    <body>
        <div class="layui-fluid">
            <div class="layui-row">
                <form class="layui-form">
					<div class="layui-form-item">
                        <label for="goodsName" class="layui-form-label">
                            <span class="x-red">*</span>商品名称</label>
                        <div class="layui-input-inline">
                            <input type="text" id="goodsName" name="goodsName"  class="layui-input"></div>
                    </div>
                    <div class="layui-form-item">
                        <label for="price" class="layui-form-label">
                            <span class="x-red">*</span>商品价格</label>
                        <div class="layui-input-inline">
                            <input type="text" id="price" name="price"  class="layui-input"></div>
                    </div>
                    
                    <div class="layui-form-item">
                        <label  class="layui-form-label">
                            <span class="x-red">*</span>商品类型</label>
                        <div class="layui-input-inline">
                            <select id="shipping" name="categoryId" class="valid">
								
							</select>
                        </div>
                    </div>
					<div class="layui-form-item">
					    <label for="createTime" class="layui-form-label">
					        <span class="x-red">*</span>创建时间</label>
					    <div class="layui-input-inline">
					        <input type="date" id="createTime" name="createTime"  class="layui-input"></div>
					</div>
			<div class="layui-form-item">
				<label for="L_repass" class="layui-form-label"></label>
				<button class="layui-btn" lay-filter="add" lay-submit="">添加员工</button>
			</div>
        </form>
        </div>
        </div>
		<script>
			
			layui.use(['form'],function(){
				
				//获取form对象
				var form = layui.form;
				var $ = layui.jquery;
				
				//AJAX请求
				$.getJSON("http://localhost:8080/PassThree_LastWeekTest_war_exploded/getCategoryList",function(d){
					//console.log("d=",d);
					var r = d.data;
					var str="";
					for(var i=0;i<r.length;i++){
						str+="<option value=\""+r[i].categoryId+"\">"+r[i].categoryName+"</option>";
					}
					//console.log('拼接数据为:',str);
					$("#shipping").html(str);
					//重新渲染页面
					form.render("select");
				});
				
				//监听表单提交
				form.on('submit(add)',function(obj){
					
					console.log("表单提交事件被触发:",obj);
					
					//AJAX向后台发送请求
					$.post("http://localhost:8080/PassThree_LastWeekTest_war_exploded/addGoods",obj.field,function(res){
						//获取弹出层编号
						var index = parent.layer.getFrameIndex(window.name);
						//关闭弹出层
						parent.layer.close(index);
						//修改成功后刷新父界面
						window.parent.location.reload();
						if(res.code!=200){
							//添加员工失败
							layer.msg(res.msg);
						}
					},"json");
					return false;
				});
			});
		</script>
    </body>
</html>